/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/utils/logging.py:46: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if rank is 0:
/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/utils/logging.py:80: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if self.rank is 0 and global_step > 0 and global_step % self.frequent == 0:
Traceback (most recent call last):
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/tools/train.py", line 24, in <module>
    args = parser.parse_args()
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/configs/argparser.py", line 72, in parse_args
    cfg = get_config(user_namespace.config_file)
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/configs/argparser.py", line 51, in get_config
    config = importlib.import_module("configs.config")
  File "/home/airi/anaconda3/envs/paddle/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/configs/config.py", line 15, in <module>
    from easydict import EasyDict as edict
ModuleNotFoundError: No module named 'easydict'
Traceback (most recent call last):
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/tools/train.py", line 24, in <module>
    args = parser.parse_args()
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/configs/argparser.py", line 72, in parse_args
    cfg = get_config(user_namespace.config_file)
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/configs/argparser.py", line 51, in get_config
    config = importlib.import_module("configs.config")
  File "/home/airi/anaconda3/envs/paddle/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/configs/config.py", line 15, in <module>
    from easydict import EasyDict as edict
ModuleNotFoundError: No module named 'easydict'
Traceback (most recent call last):
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/train.py", line 28, in <module>
    from .utils.verification import CallBackVerification
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/utils/verification.py", line 18, in <module>
    import sklearn
ModuleNotFoundError: No module named 'sklearn'
[2023-09-27 09:00:18,326] [    INFO] distributed_strategy.py:160 - distributed strategy initialized
Traceback (most recent call last):
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/train.py", line 63, in train
    trainset = CommonDataset(
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 48, in __init__
    with open(label_file, "r") as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data_out/label.txt'
[2023-09-27 09:01:50,963] [    INFO] distributed_strategy.py:160 - distributed strategy initialized
Traceback (most recent call last):
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/train.py", line 63, in train
    trainset = CommonDataset(
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 48, in __init__
    with open(label_file, "r") as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data_out/label.txt'
[2023-09-27 09:02:20,665] [    INFO] distributed_strategy.py:160 - distributed strategy initialized
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  warnings.warn(
/home/airi/anaconda3/envs/paddle/lib/python3.9/site-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  warnings.warn(
Traceback (most recent call last):
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/train.py", line 107, in train
    train_model = StaticModel(
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/static_model.py", line 86, in __init__
    self.classifier = eval("classifiers.{}".format(
  File "/home/airi/Desktop/Shaxboz/Paddle_face_recognition/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 110, in __init__
    norm_feature = paddle.fluid.layers.l2_normalize(total_feature, axis=1)
AttributeError: module 'paddle.fluid.layers' has no attribute 'l2_normalize'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 24, in <module>
    args = parser.parse_args()
  File "/paddle/insightface/recognition/arcface_paddle/configs/argparser.py", line 72, in parse_args
    cfg = get_config(user_namespace.config_file)
  File "/paddle/insightface/recognition/arcface_paddle/configs/argparser.py", line 51, in get_config
    config = importlib.import_module("configs.config")
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/paddle/insightface/recognition/arcface_paddle/configs/config.py", line 15, in <module>
    from easydict import EasyDict as edict
ModuleNotFoundError: No module named 'easydict'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/paddle/insightface/recognition/arcface_paddle/static/train.py:231: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if rank is 0 and global_step > 0 and global_step % args.log_interval_step == 0:
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 22, in <module>
    from visualdl import LogWriter
ModuleNotFoundError: No module named 'visualdl'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 25, in <module>
    from datasets import CommonDataset, SyntheticDataset
  File "/paddle/insightface/recognition/arcface_paddle/datasets/__init__.py", line 15, in <module>
    from .common_dataset import CommonDataset, SyntheticDataset, load_bin
  File "/paddle/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 18, in <module>
    import cv2
ModuleNotFoundError: No module named 'cv2'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
[2023-09-27 04:18:41,347] [    INFO] distributed_strategy.py:160 - distributed strategy initialized
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 63, in train
    trainset = CommonDataset(
  File "/paddle/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 48, in __init__
    with open(label_file, "r") as fin:
FileNotFoundError: [Errno 2] No such file or directory: '/home/airi/Desktop/Shaxboz/Paddle_face_recognition/data_out/label.txt'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
[2023-09-27 04:21:50,884] [    INFO] distributed_strategy.py:160 - distributed strategy initialized
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 63, in train
    trainset = CommonDataset(
  File "/paddle/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 48, in __init__
    with open(label_file, "r") as fin:
FileNotFoundError: [Errno 2] No such file or directory: '/paddle/insightface/recognition/arcface_paddle/data_out/label.txt'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
[2023-09-27 04:23:31,649] [    INFO] distributed_strategy.py:160 - distributed strategy initialized
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:177: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  warnings.warn(
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 107, in train
    train_model = StaticModel(
  File "/paddle/insightface/recognition/arcface_paddle/static/static_model.py", line 86, in __init__
    self.classifier = eval("classifiers.{}".format(
  File "/paddle/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 110, in __init__
    norm_feature = paddle.fluid.layers.l2_normalize(total_feature, axis=1)
AttributeError: module 'paddle.fluid.layers' has no attribute 'l2_normalize'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.10/dist-packages/setuptools-50.3.2-py3.10.egg/setuptools/__init__.py:10: DeprecationWarning: The distutils package is deprecated and slated for removal in Python 3.12. Use setuptools or check PEP 632 for potential alternatives
/usr/lib/python3.10/distutils/command/install.py:13: DeprecationWarning: The distutils.sysconfig module is deprecated, use sysconfig instead
  from distutils.sysconfig import get_config_vars
INFO 2023-09-27 04:35:51,995 argparser.py:22] --------args----------
INFO 2023-09-27 04:35:51,995 argparser.py:24] config_file: configs/ms1mv3_r50.py
INFO 2023-09-27 04:35:51,996 argparser.py:24] is_static: True
INFO 2023-09-27 04:35:51,996 argparser.py:24] backbone: FresResNet50
INFO 2023-09-27 04:35:51,996 argparser.py:24] classifier: LargeScaleClassifier
INFO 2023-09-27 04:35:51,996 argparser.py:24] embedding_size: 512
INFO 2023-09-27 04:35:51,996 argparser.py:24] model_parallel: True
INFO 2023-09-27 04:35:51,996 argparser.py:24] sample_ratio: 0.1
INFO 2023-09-27 04:35:51,996 argparser.py:24] loss: ArcFace
INFO 2023-09-27 04:35:51,996 argparser.py:24] dropout: 0.0
INFO 2023-09-27 04:35:51,996 argparser.py:24] fp16: True
INFO 2023-09-27 04:35:51,996 argparser.py:24] init_loss_scaling: 27648.0
INFO 2023-09-27 04:35:51,996 argparser.py:24] max_loss_scaling: 128.0
INFO 2023-09-27 04:35:51,996 argparser.py:24] incr_every_n_steps: 2000
INFO 2023-09-27 04:35:51,996 argparser.py:24] decr_every_n_nan_or_inf: 1
INFO 2023-09-27 04:35:51,996 argparser.py:24] incr_ratio: 2.0
INFO 2023-09-27 04:35:51,996 argparser.py:24] decr_ratio: 0.5
INFO 2023-09-27 04:35:51,996 argparser.py:24] use_dynamic_loss_scaling: True
INFO 2023-09-27 04:35:51,996 argparser.py:24] custom_white_list: []
INFO 2023-09-27 04:35:51,996 argparser.py:24] custom_black_list: []
INFO 2023-09-27 04:35:51,996 argparser.py:24] lr: 0.1
INFO 2023-09-27 04:35:51,996 argparser.py:24] lr_decay: 0.1
INFO 2023-09-27 04:35:51,996 argparser.py:24] weight_decay: 0.0005
INFO 2023-09-27 04:35:51,996 argparser.py:24] momentum: 0.9
INFO 2023-09-27 04:35:51,996 argparser.py:24] train_unit: epoch
INFO 2023-09-27 04:35:51,996 argparser.py:24] warmup_num: 0
INFO 2023-09-27 04:35:51,996 argparser.py:24] train_num: 25
INFO 2023-09-27 04:35:51,996 argparser.py:24] decay_boundaries: [10, 16, 22]
INFO 2023-09-27 04:35:51,996 argparser.py:24] use_synthetic_dataset: False
INFO 2023-09-27 04:35:51,996 argparser.py:24] dataset: MS1M_v2
INFO 2023-09-27 04:35:51,996 argparser.py:24] data_dir: /paddle/data_out/
INFO 2023-09-27 04:35:51,996 argparser.py:24] label_file: /paddle/data_out/label.txt
INFO 2023-09-27 04:35:51,996 argparser.py:24] is_bin: False
INFO 2023-09-27 04:35:51,996 argparser.py:24] num_classes: 85741
INFO 2023-09-27 04:35:51,996 argparser.py:24] batch_size: 128
INFO 2023-09-27 04:35:51,996 argparser.py:24] num_workers: 2
INFO 2023-09-27 04:35:51,996 argparser.py:24] do_validation_while_train: True
INFO 2023-09-27 04:35:51,996 argparser.py:24] validation_interval_step: 2000
INFO 2023-09-27 04:35:51,996 argparser.py:24] val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO 2023-09-27 04:35:51,996 argparser.py:24] logdir: ./log
INFO 2023-09-27 04:35:51,996 argparser.py:24] log_interval_step: 100
INFO 2023-09-27 04:35:51,996 argparser.py:24] output: MS1M_v3_arcface_static_0.1
INFO 2023-09-27 04:35:51,996 argparser.py:24] resume: False
INFO 2023-09-27 04:35:51,996 argparser.py:24] checkpoint_dir: None
INFO 2023-09-27 04:35:51,996 argparser.py:24] max_num_last_checkpoint: 1
INFO 2023-09-27 04:35:51,996 argparser.py:25] ------------------------

INFO 2023-09-27 04:35:52,299 common_dataset.py:55] read label file finished, total num: 5822653
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py:1104: FutureWarning: In the future `np.bool` will be defined as the corresponding NumPy scalar.
  elif dtype == np.bool:
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 107, in train
    train_model = StaticModel(
  File "/paddle/insightface/recognition/arcface_paddle/static/static_model.py", line 132, in __init__
    dist_optimizer.minimize(self.classifier.output_dict[
  File "/usr/local/lib/python3.10/dist-packages/paddle/distributed/fleet/base/fleet_base.py", line 1494, in minimize
    return self._minimize_impl(loss, startup_program, parameter_list,
  File "/usr/local/lib/python3.10/dist-packages/paddle/distributed/fleet/base/fleet_base.py", line 1633, in _minimize_impl
    optimize_ops, params_grads = meta_optimizer.minimize(
  File "/usr/local/lib/python3.10/dist-packages/paddle/distributed/fleet/meta_optimizers/meta_optimizer_base.py", line 94, in minimize
    optimize_ops, params_grads = self.minimize_impl(
  File "/usr/local/lib/python3.10/dist-packages/paddle/distributed/fleet/meta_optimizers/raw_program_optimizer.py", line 126, in minimize_impl
    optimize_ops, params_grads = self.inner_opt.minimize(
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/contrib/mixed_precision/decorator.py", line 523, in minimize
    optimize_ops = self.apply_optimize(loss, startup_program,
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/contrib/mixed_precision/decorator.py", line 487, in apply_optimize
    optimize_ops = self.apply_gradients(params_grads)
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/contrib/mixed_precision/decorator.py", line 336, in apply_gradients
    found_inf = self._check_finite_and_unscale(params_grads)
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/contrib/mixed_precision/decorator.py", line 393, in _check_finite_and_unscale
    _, fp32_found_inf = check_finite_and_unscale(
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/contrib/mixed_precision/amp_nn.py", line 45, in check_finite_and_unscale
    found_inf = helper.create_variable_for_type_inference(dtype='bool')
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/layer_helper_base.py", line 406, in create_variable_for_type_inference
    return self.main_program.current_block().create_var(
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py", line 3428, in create_var
    var = Variable(block=self, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py", line 1275, in __init__
    dtype = convert_np_dtype_to_dtype_(dtype)
  File "/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py", line 1104, in convert_np_dtype_to_dtype_
    elif dtype == np.bool:
  File "/usr/local/lib/python3.10/dist-packages/numpy/__init__.py", line 305, in __getattr__
    raise AttributeError(__former_attrs__[attr])
AttributeError: module 'numpy' has no attribute 'bool'.
`np.bool` was a deprecated alias for the builtin `bool`. To avoid this error in existing code, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
The aliases was originally deprecated in NumPy 1.20; for more details and guidance see the original release note at:
    https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations. Did you mean: 'bool_'?
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.10/dist-packages/setuptools-50.3.2-py3.10.egg/setuptools/__init__.py:10: DeprecationWarning: The distutils package is deprecated and slated for removal in Python 3.12. Use setuptools or check PEP 632 for potential alternatives
/usr/lib/python3.10/distutils/command/install.py:13: DeprecationWarning: The distutils.sysconfig module is deprecated, use sysconfig instead
  from distutils.sysconfig import get_config_vars
INFO 2023-09-27 04:36:33,281 argparser.py:22] --------args----------
INFO 2023-09-27 04:36:33,282 argparser.py:24] config_file: configs/ms1mv3_r50.py
INFO 2023-09-27 04:36:33,282 argparser.py:24] is_static: True
INFO 2023-09-27 04:36:33,282 argparser.py:24] backbone: FresResNet50
INFO 2023-09-27 04:36:33,282 argparser.py:24] classifier: LargeScaleClassifier
INFO 2023-09-27 04:36:33,282 argparser.py:24] embedding_size: 512
INFO 2023-09-27 04:36:33,282 argparser.py:24] model_parallel: True
INFO 2023-09-27 04:36:33,282 argparser.py:24] sample_ratio: 0.1
INFO 2023-09-27 04:36:33,282 argparser.py:24] loss: ArcFace
INFO 2023-09-27 04:36:33,282 argparser.py:24] dropout: 0.0
INFO 2023-09-27 04:36:33,282 argparser.py:24] fp16: True
INFO 2023-09-27 04:36:33,282 argparser.py:24] init_loss_scaling: 27648.0
INFO 2023-09-27 04:36:33,282 argparser.py:24] max_loss_scaling: 128.0
INFO 2023-09-27 04:36:33,282 argparser.py:24] incr_every_n_steps: 2000
INFO 2023-09-27 04:36:33,282 argparser.py:24] decr_every_n_nan_or_inf: 1
INFO 2023-09-27 04:36:33,282 argparser.py:24] incr_ratio: 2.0
INFO 2023-09-27 04:36:33,282 argparser.py:24] decr_ratio: 0.5
INFO 2023-09-27 04:36:33,282 argparser.py:24] use_dynamic_loss_scaling: True
INFO 2023-09-27 04:36:33,282 argparser.py:24] custom_white_list: []
INFO 2023-09-27 04:36:33,282 argparser.py:24] custom_black_list: []
INFO 2023-09-27 04:36:33,282 argparser.py:24] lr: 0.1
INFO 2023-09-27 04:36:33,282 argparser.py:24] lr_decay: 0.1
INFO 2023-09-27 04:36:33,282 argparser.py:24] weight_decay: 0.0005
INFO 2023-09-27 04:36:33,282 argparser.py:24] momentum: 0.9
INFO 2023-09-27 04:36:33,282 argparser.py:24] train_unit: epoch
INFO 2023-09-27 04:36:33,282 argparser.py:24] warmup_num: 0
INFO 2023-09-27 04:36:33,282 argparser.py:24] train_num: 25
INFO 2023-09-27 04:36:33,282 argparser.py:24] decay_boundaries: [10, 16, 22]
INFO 2023-09-27 04:36:33,282 argparser.py:24] use_synthetic_dataset: False
INFO 2023-09-27 04:36:33,282 argparser.py:24] dataset: MS1M_v2
INFO 2023-09-27 04:36:33,282 argparser.py:24] data_dir: /paddle/data_out/
INFO 2023-09-27 04:36:33,282 argparser.py:24] label_file: /paddle/data_out/label.txt
INFO 2023-09-27 04:36:33,282 argparser.py:24] is_bin: False
INFO 2023-09-27 04:36:33,282 argparser.py:24] num_classes: 85741
INFO 2023-09-27 04:36:33,282 argparser.py:24] batch_size: 128
INFO 2023-09-27 04:36:33,282 argparser.py:24] num_workers: 2
INFO 2023-09-27 04:36:33,282 argparser.py:24] do_validation_while_train: True
INFO 2023-09-27 04:36:33,282 argparser.py:24] validation_interval_step: 2000
INFO 2023-09-27 04:36:33,282 argparser.py:24] val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO 2023-09-27 04:36:33,282 argparser.py:24] logdir: ./log
INFO 2023-09-27 04:36:33,282 argparser.py:24] log_interval_step: 100
INFO 2023-09-27 04:36:33,282 argparser.py:24] output: MS1M_v3_arcface_static_0.1
INFO 2023-09-27 04:36:33,282 argparser.py:24] resume: False
INFO 2023-09-27 04:36:33,282 argparser.py:24] checkpoint_dir: None
INFO 2023-09-27 04:36:33,282 argparser.py:24] max_num_last_checkpoint: 1
INFO 2023-09-27 04:36:33,282 argparser.py:25] ------------------------

INFO 2023-09-27 04:36:33,577 common_dataset.py:55] read label file finished, total num: 5822653
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py:1104: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/optimizer/momentum.py:270: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/executor.py:400: UserWarning: do not use standalone executor in fleet by default
  warnings.warn("do not use standalone executor in fleet by default")
W0927 04:36:34.728669  7368 gpu_context.cc:278] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 10.1
W0927 04:36:34.729465  7368 gpu_context.cc:306] device: 1, cuDNN Version: 8.9.
I0927 04:36:36.500406  7368 gen_comm_id_helper.cc:205] Server listening on: 127.0.0.1:42839 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::Run(paddle::framework::ProgramDesc const&, paddle::framework::Scope*, int, bool, bool, std::vector<std::string, std::allocator<std::string > > const&, bool, bool)
1   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
2   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
3   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, phi::Place const&)
4   paddle::operators::CCommInitOp::RunImpl(paddle::framework::Scope const&, phi::Place const&) const
5   paddle::platform::NCCLCommContext::CreateComm(ncclUniqueId*, int, int, int, int)
6   pncclCommInitRank

----------------------
Error Message Summary:
----------------------
FatalError: `Access to an undefined portion of a memory object` is detected by the operating system.
  [TimeInfo: *** Aborted at 1695789412 (unix time) try "date -d @1695789412" if you are using GNU date ***]
  [SignalInfo: *** SIGBUS (@0x7f11e9ffefe0) received by PID 7368 (TID 0x7f13aa431740) from PID 18446744073340448736 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.10/dist-packages/setuptools-50.3.2-py3.10.egg/setuptools/__init__.py:10: DeprecationWarning: The distutils package is deprecated and slated for removal in Python 3.12. Use setuptools or check PEP 632 for potential alternatives
/usr/lib/python3.10/distutils/command/install.py:13: DeprecationWarning: The distutils.sysconfig module is deprecated, use sysconfig instead
  from distutils.sysconfig import get_config_vars
INFO 2023-09-27 04:39:13,547 argparser.py:22] --------args----------
INFO 2023-09-27 04:39:13,547 argparser.py:24] config_file: configs/ms1mv3_r50.py
INFO 2023-09-27 04:39:13,547 argparser.py:24] is_static: True
INFO 2023-09-27 04:39:13,547 argparser.py:24] backbone: FresResNet50
INFO 2023-09-27 04:39:13,547 argparser.py:24] classifier: LargeScaleClassifier
INFO 2023-09-27 04:39:13,547 argparser.py:24] embedding_size: 512
INFO 2023-09-27 04:39:13,548 argparser.py:24] model_parallel: True
INFO 2023-09-27 04:39:13,548 argparser.py:24] sample_ratio: 0.1
INFO 2023-09-27 04:39:13,548 argparser.py:24] loss: ArcFace
INFO 2023-09-27 04:39:13,548 argparser.py:24] dropout: 0.0
INFO 2023-09-27 04:39:13,548 argparser.py:24] fp16: True
INFO 2023-09-27 04:39:13,548 argparser.py:24] init_loss_scaling: 27648.0
INFO 2023-09-27 04:39:13,548 argparser.py:24] max_loss_scaling: 128.0
INFO 2023-09-27 04:39:13,548 argparser.py:24] incr_every_n_steps: 2000
INFO 2023-09-27 04:39:13,548 argparser.py:24] decr_every_n_nan_or_inf: 1
INFO 2023-09-27 04:39:13,548 argparser.py:24] incr_ratio: 2.0
INFO 2023-09-27 04:39:13,548 argparser.py:24] decr_ratio: 0.5
INFO 2023-09-27 04:39:13,548 argparser.py:24] use_dynamic_loss_scaling: True
INFO 2023-09-27 04:39:13,548 argparser.py:24] custom_white_list: []
INFO 2023-09-27 04:39:13,548 argparser.py:24] custom_black_list: []
INFO 2023-09-27 04:39:13,548 argparser.py:24] lr: 0.1
INFO 2023-09-27 04:39:13,548 argparser.py:24] lr_decay: 0.1
INFO 2023-09-27 04:39:13,548 argparser.py:24] weight_decay: 0.0005
INFO 2023-09-27 04:39:13,548 argparser.py:24] momentum: 0.9
INFO 2023-09-27 04:39:13,548 argparser.py:24] train_unit: epoch
INFO 2023-09-27 04:39:13,548 argparser.py:24] warmup_num: 0
INFO 2023-09-27 04:39:13,548 argparser.py:24] train_num: 25
INFO 2023-09-27 04:39:13,548 argparser.py:24] decay_boundaries: [10, 16, 22]
INFO 2023-09-27 04:39:13,548 argparser.py:24] use_synthetic_dataset: False
INFO 2023-09-27 04:39:13,548 argparser.py:24] dataset: MS1M_v2
INFO 2023-09-27 04:39:13,548 argparser.py:24] data_dir: /paddle/data_out/
INFO 2023-09-27 04:39:13,548 argparser.py:24] label_file: /paddle/data_out/label.txt
INFO 2023-09-27 04:39:13,548 argparser.py:24] is_bin: False
INFO 2023-09-27 04:39:13,548 argparser.py:24] num_classes: 85741
INFO 2023-09-27 04:39:13,548 argparser.py:24] batch_size: 64
INFO 2023-09-27 04:39:13,548 argparser.py:24] num_workers: 2
INFO 2023-09-27 04:39:13,548 argparser.py:24] do_validation_while_train: True
INFO 2023-09-27 04:39:13,548 argparser.py:24] validation_interval_step: 2000
INFO 2023-09-27 04:39:13,548 argparser.py:24] val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO 2023-09-27 04:39:13,548 argparser.py:24] logdir: ./log
INFO 2023-09-27 04:39:13,548 argparser.py:24] log_interval_step: 100
INFO 2023-09-27 04:39:13,548 argparser.py:24] output: MS1M_v3_arcface_static_0.1
INFO 2023-09-27 04:39:13,548 argparser.py:24] resume: False
INFO 2023-09-27 04:39:13,548 argparser.py:24] checkpoint_dir: None
INFO 2023-09-27 04:39:13,548 argparser.py:24] max_num_last_checkpoint: 1
INFO 2023-09-27 04:39:13,548 argparser.py:25] ------------------------

INFO 2023-09-27 04:39:13,862 common_dataset.py:55] read label file finished, total num: 5822653
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py:1104: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/optimizer/momentum.py:270: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/executor.py:400: UserWarning: do not use standalone executor in fleet by default
  warnings.warn("do not use standalone executor in fleet by default")
W0927 04:39:14.980859  7487 gpu_context.cc:278] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 10.1
W0927 04:39:14.981650  7487 gpu_context.cc:306] device: 1, cuDNN Version: 8.9.
I0927 04:39:16.552220  7487 gen_comm_id_helper.cc:205] Server listening on: 127.0.0.1:44493 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::Run(paddle::framework::ProgramDesc const&, paddle::framework::Scope*, int, bool, bool, std::vector<std::string, std::allocator<std::string > > const&, bool, bool)
1   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
2   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
3   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, phi::Place const&)
4   paddle::operators::CCommInitOp::RunImpl(paddle::framework::Scope const&, phi::Place const&) const
5   paddle::platform::NCCLCommContext::CreateComm(ncclUniqueId*, int, int, int, int)
6   pncclCommInitRank

----------------------
Error Message Summary:
----------------------
FatalError: `Access to an undefined portion of a memory object` is detected by the operating system.
  [TimeInfo: *** Aborted at 1695789572 (unix time) try "date -d @1695789572" if you are using GNU date ***]
  [SignalInfo: *** SIGBUS (@0x7f1a33fff000) received by PID 7487 (TID 0x7f1bf34b2740) from PID 872411136 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.10/dist-packages/setuptools-50.3.2-py3.10.egg/setuptools/__init__.py:10: DeprecationWarning: The distutils package is deprecated and slated for removal in Python 3.12. Use setuptools or check PEP 632 for potential alternatives
/usr/lib/python3.10/distutils/command/install.py:13: DeprecationWarning: The distutils.sysconfig module is deprecated, use sysconfig instead
  from distutils.sysconfig import get_config_vars
INFO 2023-09-27 04:40:15,435 argparser.py:22] --------args----------
INFO 2023-09-27 04:40:15,435 argparser.py:24] config_file: configs/ms1mv3_r50.py
INFO 2023-09-27 04:40:15,435 argparser.py:24] is_static: True
INFO 2023-09-27 04:40:15,435 argparser.py:24] backbone: FresResNet50
INFO 2023-09-27 04:40:15,435 argparser.py:24] classifier: LargeScaleClassifier
INFO 2023-09-27 04:40:15,435 argparser.py:24] embedding_size: 512
INFO 2023-09-27 04:40:15,435 argparser.py:24] model_parallel: True
INFO 2023-09-27 04:40:15,435 argparser.py:24] sample_ratio: 0.1
INFO 2023-09-27 04:40:15,435 argparser.py:24] loss: ArcFace
INFO 2023-09-27 04:40:15,435 argparser.py:24] dropout: 0.0
INFO 2023-09-27 04:40:15,435 argparser.py:24] fp16: True
INFO 2023-09-27 04:40:15,435 argparser.py:24] init_loss_scaling: 27648.0
INFO 2023-09-27 04:40:15,435 argparser.py:24] max_loss_scaling: 128.0
INFO 2023-09-27 04:40:15,435 argparser.py:24] incr_every_n_steps: 2000
INFO 2023-09-27 04:40:15,435 argparser.py:24] decr_every_n_nan_or_inf: 1
INFO 2023-09-27 04:40:15,435 argparser.py:24] incr_ratio: 2.0
INFO 2023-09-27 04:40:15,435 argparser.py:24] decr_ratio: 0.5
INFO 2023-09-27 04:40:15,435 argparser.py:24] use_dynamic_loss_scaling: True
INFO 2023-09-27 04:40:15,435 argparser.py:24] custom_white_list: []
INFO 2023-09-27 04:40:15,436 argparser.py:24] custom_black_list: []
INFO 2023-09-27 04:40:15,436 argparser.py:24] lr: 0.1
INFO 2023-09-27 04:40:15,436 argparser.py:24] lr_decay: 0.1
INFO 2023-09-27 04:40:15,436 argparser.py:24] weight_decay: 0.0005
INFO 2023-09-27 04:40:15,436 argparser.py:24] momentum: 0.9
INFO 2023-09-27 04:40:15,436 argparser.py:24] train_unit: epoch
INFO 2023-09-27 04:40:15,436 argparser.py:24] warmup_num: 0
INFO 2023-09-27 04:40:15,436 argparser.py:24] train_num: 25
INFO 2023-09-27 04:40:15,436 argparser.py:24] decay_boundaries: [10, 16, 22]
INFO 2023-09-27 04:40:15,436 argparser.py:24] use_synthetic_dataset: False
INFO 2023-09-27 04:40:15,436 argparser.py:24] dataset: MS1M_v2
INFO 2023-09-27 04:40:15,436 argparser.py:24] data_dir: /paddle/data_out/
INFO 2023-09-27 04:40:15,436 argparser.py:24] label_file: /paddle/data_out/label.txt
INFO 2023-09-27 04:40:15,436 argparser.py:24] is_bin: False
INFO 2023-09-27 04:40:15,436 argparser.py:24] num_classes: 85741
INFO 2023-09-27 04:40:15,436 argparser.py:24] batch_size: 2
INFO 2023-09-27 04:40:15,436 argparser.py:24] num_workers: 2
INFO 2023-09-27 04:40:15,436 argparser.py:24] do_validation_while_train: True
INFO 2023-09-27 04:40:15,436 argparser.py:24] validation_interval_step: 2000
INFO 2023-09-27 04:40:15,436 argparser.py:24] val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO 2023-09-27 04:40:15,436 argparser.py:24] logdir: ./log
INFO 2023-09-27 04:40:15,436 argparser.py:24] log_interval_step: 100
INFO 2023-09-27 04:40:15,436 argparser.py:24] output: MS1M_v3_arcface_static_0.1
INFO 2023-09-27 04:40:15,436 argparser.py:24] resume: False
INFO 2023-09-27 04:40:15,436 argparser.py:24] checkpoint_dir: None
INFO 2023-09-27 04:40:15,436 argparser.py:24] max_num_last_checkpoint: 1
INFO 2023-09-27 04:40:15,436 argparser.py:25] ------------------------

INFO 2023-09-27 04:40:15,748 common_dataset.py:55] read label file finished, total num: 5822653
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/framework.py:1104: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/data_feeder.py:136: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/optimizer/momentum.py:270: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/paddle/fluid/executor.py:400: UserWarning: do not use standalone executor in fleet by default
  warnings.warn("do not use standalone executor in fleet by default")
W0927 04:40:16.837805  7606 gpu_context.cc:278] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 10.1
W0927 04:40:16.838584  7606 gpu_context.cc:306] device: 1, cuDNN Version: 8.9.
I0927 04:40:18.405674  7606 gen_comm_id_helper.cc:205] Server listening on: 127.0.0.1:50627 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::Run(paddle::framework::ProgramDesc const&, paddle::framework::Scope*, int, bool, bool, std::vector<std::string, std::allocator<std::string > > const&, bool, bool)
1   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
2   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
3   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, phi::Place const&)
4   paddle::operators::CCommInitOp::RunImpl(paddle::framework::Scope const&, phi::Place const&) const
5   paddle::platform::NCCLCommContext::CreateComm(ncclUniqueId*, int, int, int, int)
6   pncclCommInitRank

----------------------
Error Message Summary:
----------------------
FatalError: `Access to an undefined portion of a memory object` is detected by the operating system.
  [TimeInfo: *** Aborted at 1695789634 (unix time) try "date -d @1695789634" if you are using GNU date ***]
  [SignalInfo: *** SIGBUS (@0x7f0147fff000) received by PID 7606 (TID 0x7f0306cda740) from PID 1207955456 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "/paddle/insightface/recognition/arcface_paddle/tools/train.py", line 24, in <module>
    args = parser.parse_args()
  File "/paddle/insightface/recognition/arcface_paddle/configs/argparser.py", line 72, in parse_args
    cfg = get_config(user_namespace.config_file)
  File "/paddle/insightface/recognition/arcface_paddle/configs/argparser.py", line 51, in get_config
    config = importlib.import_module("configs.config")
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/paddle/insightface/recognition/arcface_paddle/configs/config.py", line 15, in <module>
    from easydict import EasyDict as edict
ModuleNotFoundError: No module named 'easydict'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 26, in <module>
    from static.train import train
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 22, in <module>
    from visualdl import LogWriter
ModuleNotFoundError: No module named 'visualdl'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 26, in <module>
    from static.train import train
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 22, in <module>
    from visualdl import LogWriter
  File "/usr/local/lib/python3.7/dist-packages/visualdl/__init__.py", line 20, in <module>
    from visualdl.writer.writer import LogWriter  # noqa: F401
  File "/usr/local/lib/python3.7/dist-packages/visualdl/writer/writer.py", line 20, in <module>
    from visualdl.component.base_component import audio
  File "/usr/local/lib/python3.7/dist-packages/visualdl/component/base_component.py", line 18, in <module>
    from visualdl.proto.record_pb2 import Record
  File "/usr/local/lib/python3.7/dist-packages/visualdl/proto/record_pb2.py", line 9, in <module>
    from google.protobuf.internal import builder as _builder
ImportError: cannot import name 'builder' from 'google.protobuf.internal' (/usr/local/lib/python3.7/dist-packages/google/protobuf/internal/__init__.py)
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet50
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v2
INFO:root:data_dir: /paddle/data_out/
INFO:root:label_file: /paddle/data_out/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 85741
INFO:root:batch_size: 2
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: MS1M_v3_arcface_static_0.1
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 5822653
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W0927 05:55:04.958148 10718 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W0927 05:55:04.960268 10718 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I0927 05:55:06.617434 10718 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:51895 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
1   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
2   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, paddle::platform::Place const&)
3   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&) const
4   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&, paddle::framework::RuntimeContext*) const
5   std::_Function_handler<void (paddle::framework::ExecutionContext const&), paddle::framework::OpKernelRegistrarFunctor<paddle::platform::CUDAPlace, false, 1ul, paddle::operators::ClassCenterSampleCUDAKernel<paddle::platform::CUDADeviceContext, long>, paddle::operators::ClassCenterSampleCUDAKernel<paddle::platform::CUDADeviceContext, int> >::operator()(char const*, char const*, int) const::{lambda(paddle::framework::ExecutionContext const&)#1}>::_M_invoke(std::_Any_data const&, paddle::framework::ExecutionContext const&)
6   paddle::framework::TensorCopySync(paddle::framework::Tensor const&, paddle::platform::Place const&, paddle::framework::Tensor*)
7   paddle::framework::TensorCopySync(paddle::framework::Tensor const&, paddle::platform::Place const&, paddle::framework::Tensor*)
8   void paddle::memory::Copy<paddle::platform::CPUPlace, paddle::platform::CUDAPlace>(paddle::platform::CPUPlace, void*, paddle::platform::CUDAPlace, void const*, unsigned long, CUstream_st*)
9   paddle::platform::GpuMemcpySync(void*, void const*, unsigned long, cudaMemcpyKind)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1695794391 (unix time) try "date -d @1695794391" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x2987) received by PID 10718 (TID 0x7f13d1524740) from PID 10631 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet50
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v2
INFO:root:data_dir: /paddle/data_out/
INFO:root:label_file: /paddle/data_out/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 85741
INFO:root:batch_size: 128
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: MS1M_v3_arcface_static_0.1
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 5822653
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W0927 06:00:16.261500 10877 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W0927 06:00:16.263576 10877 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I0927 06:00:17.694218 10877 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:41303 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 199, in train
    for step, data in enumerate(train_loader):
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 715, in __next__
    data = self._reader.read_next()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/multiprocess_utils.py", line 134, in __handler__
    core._throw_error_if_process_failed()
SystemError: (Fatal) DataLoader process (pid   1. If run DataLoader by DataLoader.from_generator(...), queue capacity is set by from_generator(..., capacity=xx, ...).
  2. If run DataLoader by DataLoader(dataset, ...), queue capacity is set as 2 times of the max value of num_workers and len(places).
  3. If run by DataLoader(dataset, ..., use_shared_memory=True), set use_shared_memory=False for not using shared memory.) exited is killed by signal: 10924.
  It may be caused by insufficient shared storage space. This problem usually occurs when using docker as a development environment.
  Please use command `df -h` to check the storage space of `/dev/shm`. Shared storage space needs to be greater than (DataLoader Num * DataLoader queue capacity * 1 batch data size).
  You can solve this problem by increasing the shared storage space or reducing the queue capacity appropriately.
Bus error (at /paddle/paddle/fluid/imperative/data_loader.cc:177)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet50
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v2
INFO:root:data_dir: /paddle/data_out/
INFO:root:label_file: /paddle/data_out/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 85741
INFO:root:batch_size: 64
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: MS1M_v3_arcface_static_0.1
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 5822653
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W0927 06:01:10.618160 11034 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W0927 06:01:10.620256 11034 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I0927 06:01:12.039850 11034 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:37355 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/insightface/recognition/arcface_paddle/static/train.py", line 199, in train
    for step, data in enumerate(train_loader):
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 715, in __next__
    data = self._reader.read_next()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/multiprocess_utils.py", line 134, in __handler__
    core._throw_error_if_process_failed()
SystemError: (Fatal) DataLoader process (pid   1. If run DataLoader by DataLoader.from_generator(...), queue capacity is set by from_generator(..., capacity=xx, ...).
  2. If run DataLoader by DataLoader(dataset, ...), queue capacity is set as 2 times of the max value of num_workers and len(places).
  3. If run by DataLoader(dataset, ..., use_shared_memory=True), set use_shared_memory=False for not using shared memory.) exited is killed by signal: 11080.
  It may be caused by insufficient shared storage space. This problem usually occurs when using docker as a development environment.
  Please use command `df -h` to check the storage space of `/dev/shm`. Shared storage space needs to be greater than (DataLoader Num * DataLoader queue capacity * 1 batch data size).
  You can solve this problem by increasing the shared storage space or reducing the queue capacity appropriately.
Bus error (at /paddle/paddle/fluid/imperative/data_loader.cc:177)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet50
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v2
INFO:root:data_dir: /paddle/data_out/
INFO:root:label_file: /paddle/data_out/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 85741
INFO:root:batch_size: 16
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: MS1M_v3_arcface_static_0.1
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 5822653
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W0927 06:01:57.596825 11193 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W0927 06:01:57.598881 11193 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I0927 06:01:59.026520 11193 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:43767 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
1   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
2   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, paddle::platform::Place const&)
3   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&) const
4   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&, paddle::framework::RuntimeContext*) const
5   std::_Function_handler<void (paddle::framework::ExecutionContext const&), paddle::framework::OpKernelRegistrarFunctor<paddle::platform::CUDAPlace, false, 1ul, paddle::operators::ClassCenterSampleCUDAKernel<paddle::platform::CUDADeviceContext, long>, paddle::operators::ClassCenterSampleCUDAKernel<paddle::platform::CUDADeviceContext, int> >::operator()(char const*, char const*, int) const::{lambda(paddle::framework::ExecutionContext const&)#1}>::_M_invoke(std::_Any_data const&, paddle::framework::ExecutionContext const&)
6   paddle::framework::TensorCopySync(paddle::framework::Tensor const&, paddle::platform::Place const&, paddle::framework::Tensor*)
7   paddle::framework::TensorCopySync(paddle::framework::Tensor const&, paddle::platform::Place const&, paddle::framework::Tensor*)
8   void paddle::memory::Copy<paddle::platform::CPUPlace, paddle::platform::CUDAPlace>(paddle::platform::CPUPlace, void*, paddle::platform::CUDAPlace, void const*, unsigned long, CUstream_st*)
9   paddle::platform::GpuMemcpySync(void*, void const*, unsigned long, cudaMemcpyKind)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1695797066 (unix time) try "date -d @1695797066" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x2b62) received by PID 11193 (TID 0x7f602bd04740) from PID 11106 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet50
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: /paddle/dataset/
INFO:root:label_file: /paddle/dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 8277
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: MS1M_v3_arcface_static_0.1
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 367888
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W0928 04:38:41.236649   693 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W0928 04:38:41.238770   693 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I0928 04:38:42.688577   693 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:42079 successful.
/usr/local/lib/python3.7/dist-packages/paddle/framework/io.py:412: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3,and in 3.9 it will stop working
  if isinstance(obj, collections.Iterable) and not isinstance(obj, (
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/0.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/1.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/2.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/3.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/4.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/5.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/6.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/7.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/8.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/9.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/10.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/11.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/12.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/13.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/14.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/15.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/16.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/17.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/18.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/19.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/20.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/21.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/22.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/23.
INFO:root:Save model to MS1M_v3_arcface_static_0.1/FresResNet50/24.
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 24, in <module>
    args = parser.parse_args()
  File "/paddle/train/arcface_paddle/configs/argparser.py", line 72, in parse_args
    cfg = get_config(user_namespace.config_file)
  File "/paddle/train/arcface_paddle/configs/argparser.py", line 51, in get_config
    config = importlib.import_module("configs.config")
  File "/usr/lib/python3.7/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/paddle/train/arcface_paddle/configs/config.py", line 15, in <module>
    from easydict import EasyDict as edict
ModuleNotFoundError: No module named 'easydict'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
usage: train.py [-h] --config_file CONFIG_FILE [--is_static IS_STATIC]
                [--backbone BACKBONE] [--classifier CLASSIFIER]
                [--embedding_size EMBEDDING_SIZE]
                [--model_parallel MODEL_PARALLEL]
                [--sample_ratio SAMPLE_RATIO] [--loss LOSS]
                [--dropout DROPOUT] [--fp16 FP16]
                [--init_loss_scaling INIT_LOSS_SCALING]
                [--max_loss_scaling MAX_LOSS_SCALING]
                [--incr_every_n_steps INCR_EVERY_N_STEPS]
                [--decr_every_n_nan_or_inf DECR_EVERY_N_NAN_OR_INF]
                [--incr_ratio INCR_RATIO] [--decr_ratio DECR_RATIO]
                [--use_dynamic_loss_scaling USE_DYNAMIC_LOSS_SCALING]
                [--custom_white_list CUSTOM_WHITE_LIST]
                [--custom_black_list CUSTOM_BLACK_LIST] [--lr LR]
                [--lr_decay LR_DECAY] [--weight_decay WEIGHT_DECAY]
                [--momentum MOMENTUM] [--train_unit TRAIN_UNIT]
                [--warmup_num WARMUP_NUM] [--train_num TRAIN_NUM]
                [--decay_boundaries DECAY_BOUNDARIES]
                [--use_synthetic_dataset USE_SYNTHETIC_DATASET]
                [--dataset DATASET] [--data_dir DATA_DIR]
                [--label_file LABEL_FILE] [--is_bin IS_BIN]
                [--num_classes NUM_CLASSES] [--batch_size BATCH_SIZE]
                [--num_workers NUM_WORKERS]
                [--do_validation_while_train DO_VALIDATION_WHILE_TRAIN]
                [--validation_interval_step VALIDATION_INTERVAL_STEP]
                [--val_targets VAL_TARGETS] [--logdir LOGDIR]
                [--log_interval_step LOG_INTERVAL_STEP] [--output OUTPUT]
                [--resume RESUME] [--checkpoint_dir CHECKPOINT_DIR]
                [--max_num_last_checkpoint MAX_NUM_LAST_CHECKPOINT]
train.py: error: argument --num_classes: expected one argument
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: /paddle/dataset/
INFO:root:label_file: /paddle/dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 67, in train
    is_bin=args.is_bin)
  File "/paddle/train/arcface_paddle/datasets/common_dataset.py", line 48, in __init__
    with open(label_file, "r") as fin:
FileNotFoundError: [Errno 2] No such file or directory: '/paddle/dataset/label.txt'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r100.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 132, in train
    margin_loss_params=margin_loss_params, )
  File "/paddle/train/arcface_paddle/static/static_model.py", line 79, in __init__
    self.backbone_class_name))(
  File "<string>", line 1, in <module>
AttributeError: module 'static.backbones' has no attribute 'FresResNet101'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 132, in train
    margin_loss_params=margin_loss_params, )
  File "/paddle/train/arcface_paddle/static/static_model.py", line 79, in __init__
    self.backbone_class_name))(
  File "<string>", line 1, in <module>
AttributeError: module 'static.backbones' has no attribute 'FresResNet101'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet50
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 10:56:21.285763  1910 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 10:56:21.287792  1910 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 10:56:22.713882  1910 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:45783 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::Run(paddle::framework::ProgramDesc const&, paddle::framework::Scope*, int, bool, bool, std::vector<std::string, std::allocator<std::string > > const&, bool, bool)
1   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
2   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
3   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, paddle::platform::Place const&)
4   paddle::operators::CGenNCCLIdOp::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&) const
5   void paddle::platform::RecvBroadCastCommID<ncclUniqueId>(int, std::string, std::vector<ncclUniqueId, std::allocator<ncclUniqueId> >*, int)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1697540191 (unix time) try "date -d @1697540191" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x71f) received by PID 1910 (TID 0x7fbad8b2e740) from PID 1823 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:00:59.339193  2046 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:00:59.341240  2046 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:01:00.771312  2046 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:45879 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
1   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
2   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, paddle::platform::Place const&)
3   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&) const
4   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&, paddle::framework::RuntimeContext*) const
5   std::_Function_handler<void (paddle::framework::ExecutionContext const&), paddle::framework::OpKernelRegistrarFunctor<paddle::platform::CUDAPlace, false, 1ul, paddle::operators::ClassCenterSampleCUDAKernel<paddle::platform::CUDADeviceContext, long>, paddle::operators::ClassCenterSampleCUDAKernel<paddle::platform::CUDADeviceContext, int> >::operator()(char const*, char const*, int) const::{lambda(paddle::framework::ExecutionContext const&)#1}>::_M_invoke(std::_Any_data const&, paddle::framework::ExecutionContext const&)
6   paddle::framework::TensorCopySync(paddle::framework::Tensor const&, paddle::platform::Place const&, paddle::framework::Tensor*)
7   paddle::framework::TensorCopySync(paddle::framework::Tensor const&, paddle::platform::Place const&, paddle::framework::Tensor*)
8   void paddle::memory::Copy<paddle::platform::CPUPlace, paddle::platform::CUDAPlace>(paddle::platform::CPUPlace, void*, paddle::platform::CUDAPlace, void const*, unsigned long, CUstream_st*)
9   paddle::platform::GpuMemcpySync(void*, void const*, unsigned long, cudaMemcpyKind)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1697540558 (unix time) try "date -d @1697540558" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x7a7) received by PID 2046 (TID 0x7f9764a6b740) from PID 1959 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:26:25.688133  2836 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:26:25.690155  2836 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:26:27.121757  2836 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:53573 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 199, in train
    for step, data in enumerate(train_loader):
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 583, in _get_data
    data = self._data_queue.get(timeout=self._timeout)
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 105, in get
    raise Empty
_queue.Empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 505, in _thread_loop
    batch = self._get_data()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 599, in _get_data
    "pids: {}".format(len(failed_workers), pids))
RuntimeError: DataLoader 2 workers exit unexpectedly, pids: 2887, 2889
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 715, in __next__

    data = self._reader.read_next()
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:166)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 32
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:27:30.295506  3009 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:27:30.297544  3009 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:27:31.749845  3009 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:41215 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 199, in train
    for step, data in enumerate(train_loader):
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 583, in _get_data
    data = self._data_queue.get(timeout=self._timeout)
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 105, in get
    raise Empty
_queue.Empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 505, in _thread_loop
    batch = self._get_data()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 599, in _get_data
    "pids: {}".format(len(failed_workers), pids))
RuntimeError: DataLoader 2 workers exit unexpectedly, pids: 3056, 3058
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 715, in __next__

    data = self._reader.read_next()
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:166)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 16
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:28:40.021247  3162 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:28:40.023296  3162 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:28:41.457330  3162 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:34519 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 

--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::pybind::MultiDeviceFeedReader<paddle::operators::reader::LoDTensorBlockingQueue>::ReadNext[abi:cxx11]()
1   paddle::pybind::MultiDeviceFeedReader<paddle::operators::reader::LoDTensorBlockingQueue>::CheckNextStatus()
2   paddle::pybind::MultiDeviceFeedReader<paddle::operators::reader::LoDTensorBlockingQueue>::WaitFutures(std::__exception_ptr::exception_ptr*)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1697542144 (unix time) try "date -d @1697542144" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0xc03) received by PID 3162 (TID 0x7f0224dc6740) from PID 3075 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 16
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:37:03.524747  3329 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:37:03.532744  3329 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:37:06.260268  3329 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:46099 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 208, in train
    use_program_cache=True)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1244, in run
    six.reraise(*sys.exc_info())
  File "/usr/local/lib/python3.7/dist-packages/six.py", line 719, in reraise
    raise value
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1242, in run
    return_merged=return_merged)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1372, in _run_impl
    use_program_cache=use_program_cache)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1423, in _run_program
    fetch_var_name=fetch_var_name)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 733, in _add_feed_fetch_ops
    tmp_program = program.clone()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py", line 4953, in clone
    p.desc = core.ProgramDesc(self.desc)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/multiprocess_utils.py", line 134, in __handler__
    core._throw_error_if_process_failed()
SystemError: (Fatal) DataLoader process (pid   1. If run DataLoader by DataLoader.from_generator(...), queue capacity is set by from_generator(..., capacity=xx, ...).
  2. If run DataLoader by DataLoader(dataset, ...), queue capacity is set as 2 times of the max value of num_workers and len(places).
  3. If run by DataLoader(dataset, ..., use_shared_memory=True), set use_shared_memory=False for not using shared memory.) exited is killed by signal: 3375.
  It may be caused by insufficient shared storage space. This problem usually occurs when using docker as a development environment.
  Please use command `df -h` to check the storage space of `/dev/shm`. Shared storage space needs to be greater than (DataLoader Num * DataLoader queue capacity * 1 batch data size).
  You can solve this problem by increasing the shared storage space or reducing the queue capacity appropriately.
Bus error (at /paddle/paddle/fluid/imperative/data_loader.cc:177)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 16
INFO:root:num_workers: 2
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:39:05.840936  3511 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:39:05.843133  3511 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:39:07.326058  3511 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:52207 successful.
ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 ERROR: Unexpected BUS error encountered in DataLoader worker. This might be caused by insufficient shared memory (shm), please check whether use_shared_memory is set and storage space in /dev/shm is enough
 Traceback (most recent call last):
  File "tools/train.py", line 35, in <module>
    train(args)
  File "/paddle/train/arcface_paddle/static/train.py", line 208, in train
    use_program_cache=True)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1244, in run
    six.reraise(*sys.exc_info())
  File "/usr/local/lib/python3.7/dist-packages/six.py", line 719, in reraise
    raise value
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1242, in run
    return_merged=return_merged)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/executor.py", line 1342, in _run_impl
    acp._auto_checkpoint(self, program)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/incubate/checkpoint/auto_checkpoint.py", line 641, in _auto_checkpoint
    if not _can_auto_checkpoint(prog):
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/incubate/checkpoint/auto_checkpoint.py", line 565, in _can_auto_checkpoint
    ret = _check_program_oprole(program)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/incubate/checkpoint/auto_checkpoint.py", line 533, in _check_program_oprole
    if op._is_optimize_op():
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py", line 2711, in _is_optimize_op
    if not self.desc.has_attr(op_maker.kOpRoleAttrName()):
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/multiprocess_utils.py", line 134, in __handler__
    core._throw_error_if_process_failed()
SystemError: (Fatal) DataLoader process (pid   1. If run DataLoader by DataLoader.from_generator(...), queue capacity is set by from_generator(..., capacity=xx, ...).
  2. If run DataLoader by DataLoader(dataset, ...), queue capacity is set as 2 times of the max value of num_workers and len(places).
  3. If run by DataLoader(dataset, ..., use_shared_memory=True), set use_shared_memory=False for not using shared memory.) exited is killed by signal: 3557.
  It may be caused by insufficient shared storage space. This problem usually occurs when using docker as a development environment.
  Please use command `df -h` to check the storage space of `/dev/shm`. Shared storage space needs to be greater than (DataLoader Num * DataLoader queue capacity * 1 batch data size).
  You can solve this problem by increasing the shared storage space or reducing the queue capacity appropriately.
Bus error (at /paddle/paddle/fluid/imperative/data_loader.cc:177)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 16
INFO:root:num_workers: 0
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:40:02.466961  3664 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:40:02.469169  3664 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:40:03.975723  3664 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:36749 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
1   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
2   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, paddle::platform::Place const&)
3   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&) const
4   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&, paddle::framework::RuntimeContext*) const
5   std::_Function_handler<void (paddle::framework::ExecutionContext const&), paddle::framework::OpKernelRegistrarFunctor<paddle::platform::CUDAPlace, false, 0ul, paddle::operators::CSyncCalcStreamKernel<float> >::operator()(char const*, char const*, int) const::{lambda(paddle::framework::ExecutionContext const&)#1}>::_M_invoke(std::_Any_data const&, paddle::framework::ExecutionContext const&)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1697542905 (unix time) try "date -d @1697542905" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0xdf9) received by PID 3664 (TID 0x7fa4b40c7740) from PID 3577 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 64
INFO:root:num_workers: 0
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:42:04.375753  3810 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:42:04.377938  3810 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:42:05.876147  3810 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:34109 successful.


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::Executor::RunPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, bool, bool, bool)
1   paddle::framework::Executor::RunPartialPreparedContext(paddle::framework::ExecutorPrepareContext*, paddle::framework::Scope*, long, long, bool, bool, bool)
2   paddle::framework::OperatorBase::Run(paddle::framework::Scope const&, paddle::platform::Place const&)
3   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&) const
4   paddle::framework::OperatorWithKernel::RunImpl(paddle::framework::Scope const&, paddle::platform::Place const&, paddle::framework::RuntimeContext*) const
5   std::_Function_handler<void (paddle::framework::ExecutionContext const&), paddle::framework::OpKernelRegistrarFunctor<paddle::platform::CUDAPlace, false, 2ul, paddle::operators::CUDNNConvGradOpKernel<float>, paddle::operators::CUDNNConvGradOpKernel<double>, paddle::operators::CUDNNConvGradOpKernel<paddle::platform::float16>, paddle::operators::CUDNNConvGradOpKernel<paddle::platform::bfloat16> >::operator()(char const*, char const*, int) const::{lambda(paddle::framework::ExecutionContext const&)#1}>::_M_invoke(std::_Any_data const&, paddle::framework::ExecutionContext const&)
6   paddle::operators::CUDNNConvGradOpKernel<paddle::platform::float16>::Compute(paddle::framework::ExecutionContext const&) const
7   cudnnConvolutionBwdFilterAlgo_t paddle::operators::SearchAlgorithm<cudnnConvolutionBwdFilterAlgoPerf_t>::Find<paddle::platform::float16>(paddle::operators::ConvArgs const&, bool, bool, paddle::framework::ExecutionContext const&)
8   paddle::framework::AlgorithmsCache<cudnnConvolutionBwdFilterAlgo_t>::GetAlgorithm(std::vector<long, std::allocator<long> > const&, std::vector<long, std::allocator<long> > const&, std::vector<int, std::allocator<int> > const&, std::vector<int, std::allocator<int> > const&, std::vector<int, std::allocator<int> > const&, int, long, std::function<cudnnConvolutionBwdFilterAlgo_t ()>)
9   std::_Function_handler<cudnnConvolutionBwdFilterAlgo_t (), paddle::operators::SearchAlgorithm<cudnnConvolutionBwdFilterAlgoPerf_t>::Find<paddle::platform::float16>(paddle::operators::ConvArgs const&, bool, bool, paddle::framework::ExecutionContext const&)::{lambda()#2}>::_M_invoke(std::_Any_data const&)

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1697542950 (unix time) try "date -d @1697542950" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0xe8b) received by PID 3810 (TID 0x7f5cae46e740) from PID 3723 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:34: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:164: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  method='lar', copy_X=True, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:281: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_Gram=True, verbose=0,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:865: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1121: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, fit_path=True,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1149: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1379: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1621: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  max_n_alphas=1000, n_jobs=None, eps=np.finfo(np.float).eps,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_least_angle.py:1755: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  eps=np.finfo(np.float).eps, copy_X=True, positive=False):
/usr/local/lib/python3.7/dist-packages/sklearn/decomposition/_lda.py:28: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  EPS = np.finfo(np.float).eps
INFO:root:--------args----------
INFO:root:config_file: configs/ms1mv3_r50.py
INFO:root:is_static: True
INFO:root:backbone: FresResNet101
INFO:root:classifier: LargeScaleClassifier
INFO:root:embedding_size: 512
INFO:root:model_parallel: True
INFO:root:sample_ratio: 0.1
INFO:root:loss: ArcFace
INFO:root:dropout: 0.0
INFO:root:fp16: True
INFO:root:init_loss_scaling: 27648.0
INFO:root:max_loss_scaling: 128.0
INFO:root:incr_every_n_steps: 2000
INFO:root:decr_every_n_nan_or_inf: 1
INFO:root:incr_ratio: 2.0
INFO:root:decr_ratio: 0.5
INFO:root:use_dynamic_loss_scaling: True
INFO:root:custom_white_list: []
INFO:root:custom_black_list: []
INFO:root:lr: 0.1
INFO:root:lr_decay: 0.1
INFO:root:weight_decay: 0.0005
INFO:root:momentum: 0.9
INFO:root:train_unit: epoch
INFO:root:warmup_num: 0
INFO:root:train_num: 25
INFO:root:decay_boundaries: [10, 16, 22]
INFO:root:use_synthetic_dataset: False
INFO:root:dataset: MS1M_v3
INFO:root:data_dir: ../dataset/
INFO:root:label_file: ../dataset/label.txt
INFO:root:is_bin: False
INFO:root:num_classes: 657077
INFO:root:batch_size: 64
INFO:root:num_workers: 0
INFO:root:do_validation_while_train: True
INFO:root:validation_interval_step: 2000
INFO:root:val_targets: ['lfw', 'cfp_fp', 'agedb_30']
INFO:root:logdir: ./log
INFO:root:log_interval_step: 100
INFO:root:output: model
INFO:root:resume: False
INFO:root:checkpoint_dir: None
INFO:root:max_num_last_checkpoint: 1
INFO:root:------------------------

INFO:root:read label file finished, total num: 4574213
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in conv2d only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in guassian_random only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in batch_norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in prelu only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in elementwise_add only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in fc only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'Out' in xavier_init only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'dtype' in create_parameter only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'tensor' in all_gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input' in split only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[0]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'input[1]' in concat only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in gather only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'X' in norm only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'y' in matmul only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'logits' in margin_cross_entropy only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/framework.py:744: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  elif dtype == np.bool:
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in check_finite_and_unscale only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/fluid/data_feeder.py:128: UserWarning: The data type of 'x' in update_loss_scaling only support float16 in GPU now. 
  (input_name, op_name, extra_message))
/usr/local/lib/python3.7/dist-packages/paddle/optimizer/momentum.py:262: UserWarning: Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence.Consider using multi_precision=True option of the Momentum optimizer.
  "Accumulating with FP16 in optimizer can lead to poor accuracy or slow convergence."
W1017 11:42:40.670393  3958 device_context.cc:447] Please NOTE: device: 1, GPU Compute Capability: 8.6, Driver API Version: 12.0, Runtime API Version: 11.2
W1017 11:42:40.672607  3958 device_context.cc:465] device: 1, cuDNN Version: 8.1.
I1017 11:42:42.175108  3958 gen_comm_id_helper.cc:190] Server listening on: 127.0.0.1:48933 successful.
/usr/local/lib/python3.7/dist-packages/paddle/framework/io.py:412: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3,and in 3.9 it will stop working
  if isinstance(obj, collections.Iterable) and not isinstance(obj, (
INFO:root:Save model to model/FresResNet101/0.
INFO:root:Save model to model/FresResNet101/1.
INFO:root:Save model to model/FresResNet101/2.
INFO:root:Save model to model/FresResNet101/3.
